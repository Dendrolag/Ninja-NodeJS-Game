<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="icon" href="/assets/images/favicon.ico" type="image/x-icon">
    <title>To the Point</title>
    <link rel="stylesheet" href="/styles.css" rel="preload">
    <link rel="preload" href="/assets/fonts/Chewy-Regular.ttf" as="font" type="font/ttf" crossorigin>
</head>
<body>
    <!-- Menu principal -->
    <div id="mainMenu" class="active">
        <div class="menu-content">
            <h1>To the Point</h1>
            <div class="menu-form">
                <input type="text" id="nicknameInput" placeholder="Entrez votre pseudo" maxlength="15">
                <button id="startButton" class="primary-button" disabled>Rejoindre la salle</button>
            </div>
        </div>
    </div>

    <div id="waitingRoom" class="screen">
            <!-- Chatbox flottante -->
            <div class="floating-chat">
                <div class="chat-header">
                    <div class="chat-header-title">
                        <img src="/assets/images/chat.png" alt="Chat icon" class="chat-icon">
                        <h3>Chat</h3>
                    </div>
                    <span class="toggle-icon">◀</span>
                </div>
                <div class="chat-container">
                    <div class="chat-messages"></div>
                    <form id="chatForm" class="chat-input-container">
                        <input type="text" id="chatInput" placeholder="Écrivez un message..." maxlength="200">
                        <button type="submit" class="chat-send-button">Envoyer</button>
                    </form>
                </div>
            </div>

        <div class="waiting-room-content">
            <h2>Salle d'attente</h2>
            
            <div class="waiting-room-layout">       
                <!-- Section existante des joueurs -->
                <div class="waiting-room-container">
                    <div class="players-list-container">
                        <h3>Joueurs connectés</h3>
                        <ul id="waitingRoomPlayers"></ul>
                    </div>
        
                    <div class="waiting-room-buttons">
                        <button id="startGameButton" class="primary-button">Lezgoooo</button>
                        <button id="waitingRoomSettings" class="secondary-button">Paramètres</button>
                        <button id="leaveRoomButton" class="secondary-button">Quitter la salle</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Menu des paramètres -->
    <div id="settingsMenu" style="display: none;">
        <div class="settings-content">
            <h2>Paramètres du jeu</h2>         
            
            <!-- Paramètres généraux -->
            <div class="setting-group">
                <label for="gameDuration">Durée de la partie (en secondes):</label>
                <input 
                    type="number" 
                    id="gameDuration"
                    class="number-input" 
                    value="180" 
                    min="60" 
                    max="600"
                    step="30"
                >
            </div>
            
            <!-- Paramètres des bots -->
            <div class="setting-group">
                <div class="setting-header">
                <label for="initialBotCount">Nombre de bots au départ:</label>
                <input 
                    type="number" 
                    id="initialBotCount" 
                    class="number-input"
                    value="30" 
                    min="5" 
                    max="200"
                >
            </div>
                <div class="setting-header">
                    <input type="checkbox" id="enableBlackBot">
                    <label for="enableBlackBot">Activer les Bots Noirs</label>
                </div>
                <div class="setting-details">
                    <label for="blackBotCount">Nombre de Bots Noirs:</label>
                    <input type="number" id="blackBotCount" class="number-input" min="1" max="5" value="1">
                </div>
            </div>

            <div class="settings-group">
                <div class="setting-header">
                    <h3>Paramètres des bonus</h3>
                </div>
            
                <div class="setting-group">
                    <label>
                        Intervalle d'apparition des bonus (secondes) :
                        <input type="number" id="bonusSpawnInterval" class="number-input" class="number-input" min="1" max="10" value="4">
                    </label>
                </div>
            
                <div class="setting-group">
                    <div class="setting-header">
                        <input type="checkbox" id="enableSpeedBoost">
                        <label for="enableSpeedBoost">Activer le bonus de vitesse</label>
                    </div>
                    <div class="setting-details">
                        <label>
                            Durée (secondes):
                            <input type="number" id="speedBoostDuration" class="number-input" min="1" max="30" value="10">
                        </label>
                        <label>
                            Taux d'apparition (%):
                            <input type="number" id="speedBoostSpawnRate" class="number-input" min="1" max="100" value="25">
                        </label>
                    </div>
                </div>
            
                <div class="setting-group">
                    <div class="setting-header">
                        <input type="checkbox" id="enableInvincibility">
                        <label for="enableInvincibility">Activer le bonus d'invincibilité</label>
                    </div>
                    <div class="setting-details">
                        <label>
                            Durée (secondes):
                            <input type="number" id="invincibilityDuration" class="number-input" min="1" max="30" value="10">
                        </label>
                        <label>
                            Taux d'apparition (%):
                            <input type="number" id="invincibilitySpawnRate" class="number-input" min="1" max="100" value="15">
                        </label>
                    </div>
                </div>
            
                <div class="setting-group">
                    <div class="setting-header">
                        <input type="checkbox" id="enableReveal">
                        <label for="enableReveal">Activer le bonus de révélation</label>
                    </div>
                    <div class="setting-details">
                        <label>
                            Durée (secondes):
                            <input type="number" id="revealDuration" class="number-input" min="1" max="30" value="10">
                        </label>
                        <label>
                            Taux d'apparition (%):
                            <input type="number" id="revealSpawnRate" class="number-input" min="1" max="100" value="20">
                        </label>
                    </div>
                </div>
            </div>

            <div class="settings-group">
                <div class="setting-header">
                    <h3>Paramètres des malus</h3>
                </div>
            
                <div class="setting-group">
                    <div class="setting-header">
                        Activer les malus
                        <input type="checkbox" id="enableMalus">
                    </div>

                    <div class="setting-details">
                        <div>
                            <input type="checkbox" id="enableReverseControls">
                            <label for="enableReverseControls">Contrôles inversés</label>
                        </div>
                        <div>
                            <input type="checkbox" id="enableBlurVision">
                            <label for="enableBlurVision">Vision floue</label>
                        </div>
                        <div>
                            <input type="checkbox" id="enableNegativeVision">
                            <label for="enableNegativeVision">Vision négative</label>
                        </div>
                    </div>
            
                    <div class="setting-details">
                        Intervalle d'apparition (secondes):
                        <input type="number" id="malusSpawnInterval" class="number-input" min="1" max="30" value="8">
                    </div>
            
                    <div class="setting-details">
                        Taux d'apparition (%):
                        <input type="number" id="malusSpawnRate" class="number-input" min="1" max="100" value="20">
                    </div>
                </div>

                <div class="setting-group">
                <div class="setting-details">
                    <div>
                        Durée du malus Contrôles inversés (secondes):
                        <input type="number" id="reverseControlsDuration" class="number-input" min="1" max="30" value="10">
                    </div>
                    <div>
                        Durée du malus Vision floue (secondes):
                        <input type="number" id="blurDuration" class="number-input" min="1" max="30" value="12">
                    </div>
                    <div>
                        Durée du malus Vision négative (secondes):
                        <input type="number" id="negativeDuration" class="number-input" min="1" max="30" value="14">
                    </div>
                </div>
                </div>
            </div>

            <div class="setting-group">
                <div class="setting-header">
                    <div>
                        <input type="checkbox" id="enableSpecialZones">
                        <label for="enableSpecialZones">Activer les zones spéciales</label>
                    </div>
                </div>
    
                <div class="setting-details">
                    <div class="zone-type">
                        <input type="checkbox" id="enableChaosZone">
                        <label for="enableChaosZone">Zone de Chaos</label>
                    </div>
                    <div class="zone-type">
                        <input type="checkbox" id="enableRepelZone">
                        <label for="enableRepelZone">Zone Répulsive</label>
                    </div>
                    <div class="zone-type">
                        <input type="checkbox" id="enableAttractZone">
                        <label for="enableAttractZone">Zone Attractive</label>
                    </div>
                    <div class="zone-type">
                        <input type="checkbox" id="enableStealthZone">
                        <label for="enableStealthZone">Zone d'Invisibilité</label>
                    </div>
                </div>
            </div>

            <!-- Boutons du menu des paramètres -->
            <div class="settings-buttons">
                <button id="saveSettingsButton" class="primary-button">Enregistrer</button>
                <button id="resetSettingsButton" class="secondary-button">Réinitialiser</button>
                <button id="backToMenuButton" class="secondary-button">Retour</button>
            </div>
        
        </div>
    </div>

    <!-- Écran de jeu -->
    <div id="gameScreen">
        <!-- Conteneur du canvas -->
        <div id="gameContainer">
            <canvas id="gameCanvas" style="position: absolute; top: 0; left: 0;" width="100%" height="100%"></canvas>
        </div>

        <div id="mobileControls" class="mobile-controls">
            <!-- Joystick -->
            <div class="joystick">
                <div class="joystick-base">
                    <div class="joystick-stick"></div>
                </div>
            </div>
        
            <!-- Bouton de localisation -->
            <button id="mobileLocateButton" class="mobile-action-button">
                <img src="/assets/images/locate.png" alt="Localiser" />
            </button>
        </div>

        <!-- Interface de jeu -->
        <div id="gameInterface">
            <!-- Notification des bonus -->
            <div id="collectedBonusDisplay" class="hidden">
                <div id="collectedBonusDisplayContent"></div>
            </div>

            <!-- Zone des bonus actifs -->
            <div id="activeBonuses"></div>

            <!-- Liste des joueurs -->
            <div id="playerList">
                <h3>Classement</h3>
                <ul id="players"></ul>
            </div>

            <!-- Overlay de jeu (timer, score, pause) -->
            <div id="gameOverlay">
                <div id="gameInfo">
                    <div id="timer">
                        <div id="timerContent">
                            <div id="timerLabel">Temps restant</div>
                            <div id="time">180</div>
                        </div>
                    </div>
                    <div id="score"></div>
                </div>
                <button id="pauseButton" class="game-button">
                    Pause
                </button>
            </div>
        </div>

        <!-- Instructions du jeu -->
        <div id="instructions" class="game-help-panel">
            <div class="help-content">
                <div class="help-header">
                    <h3>Comment jouer</h3>
                    <button class="close-button" id="closeInstructions">&times;</button>
                </div>
                <div class="help-body">
                    <p>
                        Déplacez-vous pour capturer les autres joueurs et les bots.
                        Collectez les bonus pour obtenir des avantages temporaires.
                    </p>
                    <div class="bonus-list">
                        <div class="bonus-item">
                            <img src="/assets/images/speed.svg" alt="Vitesse" style="height: 20px;"/>
                            <span>Boost de vitesse : Déplacez-vous plus rapidement</span>
                        </div>
                        <div class="bonus-item">
                            <img src="/assets/images/shield.svg" alt="Bouclier" style="height: 20px;"/>
                            <span>Invincibilité : Évitez d'être capturé</span>
                        </div>
                        <div class="bonus-item">
                            <img src="/assets/images/eye.svg" alt="Œil" style="height: 20px;"/>
                            <span>Révélation : Identifiez les vrais joueurs</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Commandes du jeu -->
        <div id="controls" class="game-help-panel">
            <div class="help-content">
                <div class="help-header">
                    <h3>Commandes</h3>
                    <button class="close-button" id="closeControls">&times;</button>
                </div>
                <div class="help-body">
                    <div class="controls-grid">
                        <div class="control-item">
                            <span class="key">↑</span> ou <span class="key">Z</span>
                            <span class="action">Monter</span>
                        </div>
                        <div class="control-item">
                            <span class="key">↓</span> ou <span class="key">S</span>
                            <span class="action">Descendre</span>
                        </div>
                        <div class="control-item">
                            <span class="key">←</span> ou <span class="key">Q</span>
                            <span class="action">Gauche</span>
                        </div>
                        <div class="control-item">
                            <span class="key">→</span> ou <span class="key">D</span>
                            <span class="action">Droite</span>
                        </div>
                        <div class="control-item">
                            <span class="key">F</span>
                            <span class="action">Localiser votre point</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="/client.js"></script>
</body>
</html>